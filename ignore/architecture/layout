┌─────────────────────────────────────────────────────────────────────────────────┐
│                              ENTRY POINTS                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Azure DevOps   │    │   Manual Test   │    │  Custom Webhook │          │
│  │   Pipeline      │    │   (main.py)     │    │   Integration   │          │
│  │   (Trigger)     │    │                 │    │                 │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │   Build Event   │    │  YAML Analysis  │    │  Event Handler  │          │
│  │   (Webhook)     │    │  (Security)     │    │  (Validation)   │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        WEBHOOK PROCESSING LAYER                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Webhook Server │    │  Event Parser   │    │  Duplicate Check│          │
│  │   (Flask)       │───▶│  (JSON Parse)   │───▶│  (Build ID)     │          │
│  │   Port: 5000    │    │                 │    │                 │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  ngrok Tunnel   │    │  Event Queue    │    │  Event Logger   │          │
│  │  (HTTPS)        │    │  (Processing)   │    │  (Audit Trail)  │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        SECURITY ANALYSIS ENGINE                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  YAML Parser    │    │  Pattern Matcher│    │  Risk Scorer    │          │
│  │  (Content)      │───▶│  (250+ Regex)   │───▶│  (Critical/High)│          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Whitelist      │    │  Category       │    │  Severity       │          │
│  │  (Safe Patterns)│    │  Classifier     │    │  Calculator     │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        PATTERN DETECTION CATEGORIES                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐│
│  │ Core Language   │  │ Cloud & Container│  │ Modern Exploit  │  │ Framework   ││
│  │ (eval, exec)    │  │ (Docker, K8s)   │  │ (Log4Shell)     │  │ Security    ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────┘│
│           │                       │                       │                       │
│           ▼                       ▼                       ▼                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐│
│  │ Anti-Analysis   │  │ Network Security│  │ Mobile Security │  │ CI/CD Abuse ││
│  │ (Anti-Debug)    │  │ (SSH, VPN)      │  │ (Android/iOS)   │  │ (Jenkins)   ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────┘│
│           │                       │                       │                       │
│           ▼                       ▼                       ▼                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐│
│  │ Infrastructure  │  │ Data Exfiltration│  │ Real-time       │  │ Risk        ││
│  │ as Code (IaC)   │  │ (Network, Cloud)│  │ Monitoring      │  │ Scoring     ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────┘│
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        DATA STORAGE & PERSISTENCE                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  SQLite DB      │    │  Log Manager    │    │  Backup Manager │          │
│  │  (Events)       │───▶│  (5 Categories)│───▶│  (Auto Backup)  │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Webhook Events │    │  Security Alerts│    │  Pipeline       │          │
│  │  (Build Data)   │    │  (Findings)     │    │  Analysis       │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Pattern Stats  │    │  Audit Trail   │    │  Error Logs     │          │
│  │  (Statistics)   │    │  (User Actions)│    │  (Debug Info)   │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        NOTIFICATION & OUTPUT SYSTEM                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Slack Notifier │    │  Alert Formatter│    │  Message Queue  │          │
│  │  (Real-time)    │───▶│  (Rich Text)    │───▶│  (Reliability)  │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Security Alert │    │  Pattern List   │    │  Risk Summary   │          │
│  │  (Critical)     │    │  (Details)      │    │  (Score: 8.5)   │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Channel Config │    │  Template       │    │  Retry Logic    │          │
│  │  (#security)    │    │  (Custom)       │    │  (3 Attempts)   │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                        CONFIGURATION & ENVIRONMENT                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  .env File      │    │  Azure Config   │    │  Slack Config   │          │
│  │  (Variables)    │───▶│  (PAT, Org)     │───▶│  (Webhook URL)  │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Pattern Files  │    │  Log Config     │    │  Database Config│          │
│  │  (blacklist.json│    │  (5 Levels)     │    │  (SQLite)       │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              MONITORING & METRICS                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Event Counter  │    │  Pattern Stats  │    │  Alert Counter  │          │
│  │  (Real-time)    │───▶│  (250+ Types)   │───▶│  (Success Rate) │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
│           │                       │                       │                   │
│           ▼                       ▼                       ▼                   │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐          │
│  │  Performance    │    │  Error Rate     │    │  Uptime         │          │
│  │  (Response Time)│    │  (Monitoring)   │    │  (99.9%)        │          │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────────┘